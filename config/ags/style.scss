// ============================================================================
// AGS STYLE - Dark Purple Theme (GTK4) - macOS-inspired
// ============================================================================
@use "sass:color";

$bg-dark: #0d0d0d;
$bg-surface: #121218;
$bg-elevated: #1a1a2e;
$bg-hover: #252538;
$purple-primary: #9d4edd;
$purple-secondary: #7b2cbf;
$purple-dim: #5a189a;
$purple-glow: rgba(157, 78, 221, 0.3);
$purple-subtle: rgba(157, 78, 221, 0.08);
$text-active: #ff79c6;
$text-primary: #e0e0e0;
$text-secondary: #a0a0a0;
$text-dim: #606060;
$red-accent: #e84057;
$green-accent: #50fa7b;
$border-subtle: rgba(255, 255, 255, 0.06);
$bar-radius: 15px;
$bar-bg: #1e1f29;
$bar-fg: #f8f8f2;
$bar-fg-color: #{"@theme_fg_color"};
$bar-bg-color: #{"@theme_bg_color"};
$accent: #378DF7;

// ============================================================================
// SHARED POPUP STYLES - macOS-inspired
// ============================================================================
@mixin popup-base {
    background: transparent;
    color: $text-primary;
    font-family: "Hack Nerd Font", "JetBrains Mono Nerd Font", "JetBrains Mono", monospace;
    font-size: 16px;
}

@mixin popup-content {
    background: linear-gradient(180deg, rgba(18, 18, 24, 0.98) 0%, rgba(13, 13, 13, 0.98) 100%);
    // border: 1px solid $border-subtle;
    border-radius: 12px;
    padding: 16px;
    margin: 8px;
    border: 2px solid $purple-primary;
    // box-shadow:
    //     0 8px 32px rgba(0, 0, 0, 0.4),
    //     0 2px 8px rgba(0, 0, 0, 0.2),
    //     inset 0 1px 0 rgba(255, 255, 255, 0.04);
}

@mixin smooth-button {
    transition: background 150ms ease, color 150ms ease, border-color 150ms ease;
    border: none;

    &:hover {
        transition: background 100ms ease, color 100ms ease;
    }
}

window.Bar {
    background: transparent;
    background-color: $bar-bg;
    color: $bar-fg;
    // font-family: "Hack Nerd Font", "JetBrains Mono Nerd Font", "JetBrains Mono", monospace;
    font-size: 16px;
    font-weight: bold;
    border-radius: $bar-radius;

    .centerbox {
        background: $bar-bg-color;
        min-height: 36px;
        padding: 0 12px;

        border-radius: $bar-radius;

        outline: 2px solid $purple-primary;
        outline-offset: -2px;
    }


    // Workspaces
    .workspaces {
        button {
            min-width: 20px;
            min-height: 26px;
            margin: 5px 2px;
            padding: 0 8px;
            border-radius: 6px;
            background: transparent;
            color: $text-dim;

            &:hover {
                // background-color: color.adjust($bar-fg, $alpha: -0.84);
                // border-color: color.adjust($accent, $alpha: -0.8);
                color: $text-secondary;
            }

            &.active {
                background-color: color.adjust($bar-fg, $alpha: -0.8);
                color: $text-active;
            }

            &.occupied {
                // color: $purple-secondary;
                color: $text-primary;
                background: rgba(157, 78, 221, 0.1);
            }
        }
    }

    .FocusedClient {
        // color: $accent;
        color: #ff79c6;
    }

    // Clients
    .clients {
        margin-left: 8px;
        padding-left: 8px;
        border-left: 1px solid $bg-elevated;

        button.client {
            min-width: 30px;
            min-height: 26px;
            margin: 5px 2px;
            padding: 0 6px;
            border-radius: 6px;
            background: transparent;
            color: $text-secondary;

            &:hover {
                background: $bg-elevated;
                // color: $purple-primary;
            }

            &.focused {
                background: $bg-elevated;
                // color: $purple-primary;
            }

            .client-icon {
                font-family: "Source Code Pro", "Hack Nerd Font", "Symbols Nerd Font", monospace;
                font-size: 16px;
                font-weight: bold;
            }
        }
    }

    // Clock
    .clock {
        padding: 0 16px;

        .time {
            font-size: 16px;
            font-weight: bold;
            color: $text-primary;
        }

        .date {
            font-size: 16px;
            font-weight: bold;
            color: $text-primary;
            margin-left: 12px;
        }
    }

    // System tray
    .systray {
        .systray-btn {
            min-width: 26px;
            min-height: 24px;
            margin: 1px 1px;
            padding: 0 2px;
            border-radius: 5px;
            background: transparent;

            .icon {
                // color: $purple-primary;
                font-size: 18px;
            }

            &:hover {
                background: $bg-elevated;
            }

            &.muted .icon {
                color: $text-dim;
            }

            &.active .icon {
                color: #ffcc00; // Yellow for caffeine active
            }

        }
    }

    button {
        background: transparent;
        border: none;
    }
}

// Audio Popup - macOS-style (Enhanced with device/profile/media controls)
window.AudioPopup {
    @include popup-base;

    .audio-popup-content {
        @include popup-content;
        min-width: 204px; // Reduced by ~35% total
    }

    .audio-header {
        margin-bottom: 14px;
        padding-bottom: 10px;
        border-bottom: 1px solid $border-subtle;

        .popup-title {
            font-size: 16px;
            font-weight: 600;
            color: $text-primary;
            letter-spacing: 0.3px;
        }
    }

    // Section title (shared)
    .section-title {
        font-size: 14px;
        color: $text-dim;
        text-transform: uppercase;
        letter-spacing: 0.8px;
        margin-bottom: 8px;
        font-weight: 600;
    }

    .volume-section {
        margin-bottom: 14px;

        .volume-row {
            margin-bottom: 10px;

            label {
                color: $text-secondary;
                font-size: 14px;
                font-weight: 500;
            }

            .volume-value {
                color: $purple-primary;
                font-weight: 600;
                font-size: 14px;
            }
        }

        .volume-slider {
            min-height: 36px;

            trough {
                min-height: 4px;
                border-radius: 2px;
                background: rgba(255, 255, 255, 0.1);
            }

            highlight {
                background: $purple-primary;
                border-radius: 2px;
            }

            slider {
                min-width: 18px;
                min-height: 18px;
                margin: -7px;
                border-radius: 9px;
                background: #ffffff;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);

                &:hover {
                    background: #f0f0f0;
                }
            }
        }

        .controls-row {
            margin-top: 10px;
        }

        .mute-btn {
            @include smooth-button;
            min-height: 32px;
            padding: 0 14px;
            border-radius: 8px;
            background: $bg-elevated;
            color: $text-secondary;
            font-size: 14px;
            font-weight: 500;

            &:hover {
                background: $bg-hover;
                color: $purple-primary;
            }

            &.active {
                background: rgba($red-accent, 0.15);
                color: $red-accent;

                &:hover {
                    background: rgba($red-accent, 0.25);
                }
            }
        }
    }

    // Mute section (separate from volume, below media)
    .mute-section {
        margin-top: 8px;

        .mute-btn {
            @include smooth-button;
            min-height: 32px;
            padding: 0 14px;
            border-radius: 8px;
            background: $bg-elevated;
            color: $text-secondary;
            font-size: 14px;
            font-weight: 500;

            &:hover {
                background: $bg-hover;
                color: $purple-primary;
            }

            &.active {
                background: rgba($red-accent, 0.15);
                color: $red-accent;

                &:hover {
                    background: rgba($red-accent, 0.25);
                }
            }
        }
    }

    // Dropdown sections
    .dropdown-section {
        margin-top: 12px;
    }

    .dropdown-header {
        @include smooth-button;
        padding: 10px 12px;
        border-radius: 10px;
        background: rgba(0, 0, 0, 0.2);

        &:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .dropdown-icon {
            font-size: 18px;
            color: $purple-primary;
            min-width: 24px;
        }

        .dropdown-title {
            font-size: 14px;
            color: $text-dim;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .dropdown-value {
            font-size: 16px;
            color: $text-primary;
            font-weight: 500;
        }

        .dropdown-arrow {
            font-size: 14px;
            color: $text-dim;
            transition: color 150ms ease;
        }

        &:hover .dropdown-arrow {
            color: $purple-primary;
        }
    }

    .dropdown-options {
        margin-top: 4px;
        padding: 4px;
        background: rgba(0, 0, 0, 0.15);
        border-radius: 8px;
        overflow: hidden;

        &.collapsed {
            // GTK4 doesn't support max-height animations well, so we hide it
            margin: 0;
            padding: 0;
            min-height: 0;
            opacity: 0;
        }
    }

    .dropdown-option {
        @include smooth-button;
        padding: 8px 12px;
        margin: 2px 0;
        border-radius: 6px;
        background: transparent;
        font-size: 14px;

        &:hover {
            background: $bg-hover;
        }

        &.active {
            background: rgba($purple-primary, 0.15);
            color: $purple-primary;
        }

        .option-check {
            font-size: 16px;
            color: $green-accent;
        }
    }

    // Media controls section
    .media-section {
        margin-bottom: 14px;
        padding-top: 10px;
        border-top: 1px solid $border-subtle;
    }

    .media-content {
        padding: 10px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 10px;
    }

    .no-media-label {
        font-size: 14px;
        color: $text-dim;
        padding: 8px;
    }

    .track-info {
        margin-bottom: 8px;

        .track-title {
            font-size: 16px;
            font-weight: 600;
            color: $text-primary;
        }

        .track-artist {
            font-size: 14px;
            color: $text-secondary;
        }
    }

    .progress-info {
        margin-bottom: 10px;

        .time-label {
            font-size: 12px;
            color: $text-dim;
            font-family: monospace;
        }

        .time-separator {
            font-size: 12px;
            color: $text-dim;
        }
    }

    .playback-controls {
        padding: 4px 0;

        .control-btn {
            @include smooth-button;
            min-width: 36px;
            min-height: 36px;
            padding: 0;
            border-radius: 999px; // Fully circular
            background: $bg-elevated;
            color: $text-primary;
            font-size: 16px;

            &:hover {
                background: $bg-hover;
                color: $purple-primary;
            }

            &.play-pause {
                min-width: 44px;
                min-height: 44px;
                border-radius: 999px; // Fully circular
                background: $purple-primary;
                color: #ffffff;
                font-size: 20px;

                &:hover {
                    background: $purple-secondary;
                }
            }
        }
    }

    .controls-section {
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid $border-subtle;

        .settings-btn {
            @include smooth-button;
            min-height: 36px;
            padding: 0 14px;
            border-radius: 8px;
            background: $bg-elevated;
            color: $text-secondary;
            font-size: 14px;
            font-weight: 500;
            hexpand: true;

            &:hover {
                background: $bg-hover;
                color: $purple-primary;
            }
        }
    }
}

// ============================================================================
// BRIGHTNESS POPUP
// ============================================================================

window.BrightnessPopup {
    background: transparent;
    color: $text-primary;
    font-family: "Hack Nerd Font", "JetBrains Mono Nerd Font", "JetBrains Mono", monospace;
    font-size: 16px;

    .brightness-popup-content {
        background: $bg-dark;
        border: 2px solid $purple-primary;
        border-radius: 8px;
        padding: 12px;
        margin: 8px;
        min-width: 300px;
    }

    .brightness-header {
        margin-bottom: 12px;
        padding-bottom: 8px;
        border-bottom: 1px solid $bg-elevated;

        .popup-title {
            font-size: 15px;
            font-weight: bold;
            color: $purple-primary;
        }
    }

    .brightness-section {
        margin-bottom: 12px;

        .brightness-row {
            margin-bottom: 8px;

            label {
                color: $text-secondary;
                font-size: 14px;
            }

            .brightness-value {
                color: $purple-primary;
                font-weight: bold;
            }
        }

        .brightness-slider {
            min-height: 32px;

            trough {
                min-height: 6px;
                border-radius: 3px;
                background: $bg-elevated;
            }

            highlight {
                background: linear-gradient(90deg, $purple-secondary, $purple-primary);
                border-radius: 3px;
            }

            slider {
                min-width: 16px;
                min-height: 16px;
                border-radius: 8px;
                background: $purple-primary;

                &:hover {
                    background: #b565e8;
                }
            }
        }
    }

    .nightlight-section {
        padding: 10px;
        background: $bg-elevated;
        border-radius: 6px;
        margin-bottom: 8px;

        .nightlight-info {
            .nightlight-icon {
                color: $purple-primary;
                font-size: 16px;
            }

            .nightlight-label {
                font-size: 16px;
                font-weight: 500;
                color: $text-primary;
            }

            .nightlight-description {
                font-size: 14px;
                color: $text-dim;
                margin-top: 2px;
            }
        }

        .toggle-btn {
            background: $bg-dark;
            color: $text-dim;
            border: 1px solid $text-dim;
            border-radius: 6px;
            padding: 4px 12px;
            font-size: 14px;
            font-weight: bold;
            min-width: 45px;

            &:hover {
                background: #1a1a1a;
                border-color: $purple-dim;
                color: $text-secondary;
            }

            &.active {
                background: linear-gradient(135deg, $purple-secondary, $purple-primary);
                color: #ffffff;
                border-color: $purple-primary;

                &:hover {
                    background: linear-gradient(135deg, #8e32d9, #af5fee);
                }
            }
        }
    }

    .settings-btn {
        background: rgba($purple-primary, 0.1);
        border: none;
        border-radius: 6px;
        padding: 10px;
        color: $purple-primary;
        font-size: 13px;

        &:hover {
            background: rgba($purple-primary, 0.2);
            color: #b565e8;
        }

        label {
            color: inherit;
        }
    }

    .auto-section {
        padding: 8px 10px;
        background: rgba($purple-dim, 0.1);
        border-radius: 6px;
        margin-top: 8px;

        label {
            font-size: 14px;
            color: $text-secondary;
        }

        .toggle-btn {
            background: $bg-dark;
            color: $text-dim;
            border: 1px solid $text-dim;
            border-radius: 6px;
            padding: 2px 10px;
            font-size: 14px;
            font-weight: bold;
            min-width: 40px;

            &:hover {
                background: #1a1a1a;
                border-color: $purple-dim;
                color: $text-secondary;
            }

            &.active {
                background: linear-gradient(135deg, $purple-secondary, $purple-primary);
                color: #ffffff;
                border-color: $purple-primary;

                &:hover {
                    background: linear-gradient(135deg, #8e32d9, #af5fee);
                }
            }
        }
    }
}

// ============================================================================
// POPUP BACKDROP - Transparent click catcher for closing popups
// ============================================================================

window.PopupBackdrop {
    // Minimal alpha to receive clicks (ignorezero layer rule ignores transparent areas)
    background: rgba(0, 0, 0, 0.01);
}

// ============================================================================
// WIFI POPUP - macOS-style
// ============================================================================

window.WifiPopup {
    @include popup-base;

    .wifi-popup-content {
        @include popup-content;
        min-width: 300px;
    }

    .wifi-header {
        margin-bottom: 14px;
        padding-bottom: 10px;
        border-bottom: 1px solid $border-subtle;

        .popup-title {
            font-size: 14px;
            font-weight: 600;
            color: $text-primary;
            letter-spacing: 0.3px;
        }

        .toggle-btn {
            @include smooth-button;
            background: $bg-elevated;
            color: $text-dim;
            border-radius: 10px;
            padding: 4px 14px;
            font-size: 14px;
            font-weight: 600;
            min-width: 42px;

            &:hover {
                background: $bg-hover;
                color: $text-secondary;
            }

            &.active {
                background: $purple-primary;
                color: #ffffff;
            }
        }
    }

    .current-connection {
        margin-bottom: 12px;
        padding: 10px 12px;
        background: $purple-subtle;
        border-radius: 8px;
        border: 1px solid rgba($purple-primary, 0.15);

        .connection-status {
            font-size: 12px;
            color: $purple-primary;
            font-weight: 500;
        }
    }

    .scanning-indicator {
        padding: 16px;
        margin-bottom: 8px;

        .scanning-text {
            font-size: 12px;
            color: $text-secondary;
            font-weight: 500;
        }

        spinner {
            color: $purple-primary;
            min-width: 18px;
            min-height: 18px;
        }
    }

    .networks-list {
        margin-bottom: 14px;
        padding: 4px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 10px;

        .network-item {
            @include smooth-button;
            padding: 10px 12px;
            margin: 2px 0;
            border-radius: 8px;
            background: transparent;

            &:hover {
                background: $bg-hover;
            }

            &.active {
                background: linear-gradient(135deg, rgba($purple-primary, 0.25), rgba($purple-secondary, 0.2));

                .network-name {
                    color: $purple-primary;
                    font-weight: 600;
                }
            }

            &.saved:not(.active) {
                .network-name {
                    color: $text-primary;
                }
            }

            .network-name {
                font-size: 13px;
                color: $text-primary;
            }

            .network-saved {
                font-size: 12px;
                color: $green-accent;
                margin-right: 6px;
            }

            .network-security {
                font-size: 12px;
                margin-right: 6px;
                color: $text-dim;
            }

            .network-signal {
                font-size: 11px;
                color: $text-dim;
                font-family: monospace;
                min-width: 32px;
            }
        }

        .empty-label {
            font-size: 12px;
            color: $text-dim;
            padding: 20px;
        }
    }

    .password-dialog {
        padding: 12px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        margin: 4px;

        .password-network-name {
            font-size: 13px;
            font-weight: 600;
            color: $text-primary;
        }

        .password-back-btn {
            @include smooth-button;
            background: transparent;
            color: $text-dim;
            padding: 4px 8px;
            border-radius: 4px;
            min-width: 24px;

            &:hover {
                background: $bg-hover;
                color: $text-primary;
            }
        }

        .password-entry {
            background: $bg-dark;
            border: 1px solid $border-subtle;
            border-radius: 8px;
            padding: 10px 12px;
            color: $text-primary;
            font-size: 13px;
            margin: 8px 0;

            &:focus {
                border-color: $purple-primary;
            }
        }

        .password-connect-btn {
            @include smooth-button;
            background: $purple-primary;
            color: white;
            border-radius: 8px;
            padding: 10px 16px;
            font-weight: 600;
            font-size: 13px;

            &:hover {
                background: $purple-secondary;
            }

            &:disabled {
                opacity: 0.6;
            }
        }

        .password-error {
            font-size: 11px;
            color: $red-accent;
            margin-top: 6px;

            &.info {
                color: $text-secondary;
            }
        }
    }

    .controls-section {
        .settings-btn {
            @include smooth-button;
            background: $bg-elevated;
            border-radius: 8px;
            padding: 12px;
            color: $text-secondary;
            font-size: 12px;
            font-weight: 500;

            &:hover {
                background: $bg-hover;
                color: $purple-primary;
            }
        }
    }
}

// ============================================================================
// BLUETOOTH POPUP - macOS-style
// ============================================================================

// ============================================================================
// SPOTLIGHT LAUNCHER - macOS-style
// ============================================================================

window.launcher-window {
    background: transparent;
    transition: none;
}

.launcher {
    background: rgba(18, 18, 28, 0.85);
    transition: none;
    border: 2px solid $purple-primary;
    border-radius: 24px;
    // box-shadow:
    //     0 12px 40px rgba(0, 0, 0, 0.5),
    //     0 4px 16px rgba(0, 0, 0, 0.3);
    min-width: 500px;

    .search-box {
        padding: 10px 16px;
    }

    .search-icon {
        color: $purple-primary;
        opacity: 0.8;
    }

    .search-entry {
        font-size: 20px;
        // font-family: "Source Code Pro", "Noto Sans", "SF Pro Display", sans-serif;
        color: $text-primary;
        background: transparent;
        border: none;
        outline: none;
        caret-color: $purple-primary;

        &:focus {
            outline: none;
        }

        placeholder {
            color: $text-dim;
        }
    }

    .results-box {
        padding-bottom: 6px;
    }

    .results-separator {
        background: rgba($purple-primary, 0.3);
        min-height: 1px;
        margin: 0 12px 6px 12px;
    }

    .results-list {
        background: transparent;

        row {
            background: transparent;
            border-radius: 12px;
            margin: 2px 6px;
            padding: 0;

            &:selected {
                background: $purple-primary;

                .app-name {
                    color: #0d0d0d;
                    font-weight: 600;
                }
            }

            &:hover:not(:selected) {
                background: rgba($purple-primary, 0.15);
            }
        }

        .app-name {
            font-size: 16px;
            // font-family: "Source Code Pro", "Noto Sans", "SF Pro Display", sans-serif;
            color: $text-primary;
        }
    }
}

window.BluetoothPopup {
    @include popup-base;

    .bluetooth-popup-content {
        @include popup-content;
        min-width: 280px;
    }

    .bluetooth-header {
        margin-bottom: 14px;
        padding-bottom: 10px;
        border-bottom: 1px solid $border-subtle;

        .popup-title {
            font-size: 14px;
            font-weight: 600;
            color: $text-primary;
            letter-spacing: 0.3px;
        }

        .toggle-btn {
            @include smooth-button;
            background: $bg-elevated;
            color: $text-dim;
            border-radius: 10px;
            padding: 4px 14px;
            font-size: 11px;
            font-weight: 600;
            min-width: 42px;

            &:hover {
                background: $bg-hover;
                color: $text-secondary;
            }

            &.active {
                background: $purple-primary;
                color: #ffffff;
            }
        }
    }

    .devices-section {
        margin-bottom: 14px;

        .section-title {
            font-size: 10px;
            color: $text-dim;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .device-list {
            padding: 4px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .device-row {
            @include smooth-button;
            padding: 10px 12px;
            margin: 2px 0;
            border-radius: 8px;
            background: transparent;

            &:hover {
                background: $bg-hover;
            }

            .device-icon {
                font-size: 20px;
                color: $purple-primary;
                min-width: 28px;
            }

            .device-name {
                font-size: 13px;
                color: $text-primary;
                font-weight: 500;
            }

            .device-action-btn {
                @include smooth-button;
                padding: 5px 12px;
                border-radius: 6px;
                font-size: 11px;
                font-weight: 600;

                &.connect {
                    background: $purple-subtle;
                    color: $purple-primary;

                    &:hover {
                        background: rgba($purple-primary, 0.2);
                    }
                }

                &.disconnect {
                    background: rgba($red-accent, 0.12);
                    color: $red-accent;

                    &:hover {
                        background: rgba($red-accent, 0.2);
                    }
                }
            }
        }

        .empty-label {
            font-size: 12px;
            color: $text-dim;
            padding: 20px;
        }
    }

    .controls-section {
        .settings-btn {
            @include smooth-button;
            background: $bg-elevated;
            border-radius: 8px;
            padding: 12px;
            color: $text-secondary;
            font-size: 12px;
            font-weight: 500;

            &:hover {
                background: $bg-hover;
                color: $purple-primary;
            }
        }
    }
}

// ============================================================================
// POWER POPUP - macOS-style
// ============================================================================

window.PowerPopup {
    @include popup-base;

    .power-popup-content {
        @include popup-content;
        min-width: 200px;
    }

    .power-header {
        margin-bottom: 14px;
        padding-bottom: 10px;
        border-bottom: 1px solid $border-subtle;

        .popup-title {
            font-size: 14px;
            font-weight: 600;
            color: $text-primary;
            letter-spacing: 0.3px;
        }
    }

    .power-actions {
        .power-action {
            @include smooth-button;
            padding: 12px 14px;
            margin: 4px 0;
            border-radius: 8px;
            background: transparent;

            &:hover {
                background: $bg-hover;

                .action-label {
                    color: $text-primary;
                }
            }

            .action-icon {
                font-size: 18px;
                color: $purple-primary;
                min-width: 24px;
            }

            .action-label {
                font-size: 13px;
                color: $text-secondary;
                font-weight: 500;
            }

            &.logout:hover {
                background: rgba($purple-primary, 0.15);

                .action-icon,
                .action-label {
                    color: $purple-primary;
                }
            }

            &.restart:hover {
                background: rgba(255, 180, 50, 0.15);

                .action-icon,
                .action-label {
                    color: #ffb432;
                }
            }

            &.shutdown:hover {
                background: rgba($red-accent, 0.15);

                .action-icon,
                .action-label {
                    color: $red-accent;
                }
            }
        }
    }
}

// ============================================================================
// CALENDAR POPUP - macOS-style
// ============================================================================

window.CalendarPopup {
    @include popup-base;

    .calendar-popup-content {
        @include popup-content;
        min-width: 280px;
    }

    .calendar-widget {
        color: $text-primary;
        background: transparent;

        // Calendar header (month/year and navigation)
        .header {
            background: transparent;
            color: $text-primary;
            padding: 8px;
            margin-bottom: 8px;

            button {
                @include smooth-button;
                background: $bg-elevated;
                color: $text-secondary;
                border-radius: 6px;
                min-width: 32px;
                min-height: 32px;

                &:hover {
                    background: $bg-hover;
                    color: $purple-primary;
                }
            }

            .title {
                font-size: 14px;
                font-weight: 600;
                color: $text-primary;
            }
        }

        // Day names row (Mon, Tue, Wed, etc.)
        .day-names {
            color: $text-dim;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 4px 0;
        }

        // Day number cells
        .day-number {
            @include smooth-button;
            color: $text-primary;
            background: transparent;
            border-radius: 8px;
            min-width: 32px;
            min-height: 32px;
            margin: 2px;
            font-size: 13px;

            &:hover {
                background: $bg-hover;
            }

            &.other-month {
                color: $text-dim;
                opacity: 0.5;
            }

            &.today {
                background: $purple-subtle;
                color: $purple-primary;
                font-weight: 600;
                border: 1px solid $purple-primary;
            }

            &.selected {
                background: $purple-primary;
                color: #ffffff;
                font-weight: 600;

                &:hover {
                    background: $purple-secondary;
                }
            }
        }
    }
}

// ============================================================================
// MEDIA POPUP - macOS-style
// ============================================================================

window.MediaPopup {
    @include popup-base;

    .media-popup-content {
        @include popup-content;
        min-width: 280px;
    }

    .media-header {
        margin-bottom: 14px;
        padding-bottom: 10px;
        border-bottom: 1px solid $border-subtle;

        .popup-title {
            font-size: 14px;
            font-weight: 600;
            color: $text-primary;
            letter-spacing: 0.3px;
        }
    }

    .track-section {
        margin-bottom: 14px;

        .track-info {
            .track-title {
                font-size: 14px;
                font-weight: 600;
                color: $text-primary;
                margin-bottom: 4px;
                max-width: 260px;
            }

            .track-artist {
                font-size: 12px;
                color: $text-secondary;
            }

            .no-media-label {
                font-size: 12px;
                color: $text-dim;
                padding: 12px 0;
            }
        }
    }

    .progress-section {
        margin-bottom: 14px;

        .progress-info {
            justify-content: center;

            .time-label {
                font-size: 11px;
                color: $text-secondary;
                font-family: monospace;
            }

            .time-separator {
                font-size: 11px;
                color: $text-dim;
                margin: 0 6px;
            }
        }
    }

    .controls-section {
        .playback-controls {
            .control-btn {
                @include smooth-button;
                background: $bg-elevated;
                color: $text-secondary;
                border-radius: 50%;
                min-width: 40px;
                min-height: 40px;
                font-size: 18px;

                &:hover {
                    background: $bg-hover;
                    color: $purple-primary;
                }

                &.play-pause {
                    min-width: 50px;
                    min-height: 50px;
                    font-size: 22px;
                    background: $purple-primary;
                    color: #ffffff;

                    &:hover {
                        background: $purple-secondary;
                    }
                }
            }
        }
    }
}

// ============================================================================
// NOTIFICATION POPUP - macOS-style
// ============================================================================

window.NotificationPopup {
    @include popup-base;

    .notification-popup-content {
        @include popup-content;
        min-width: 400px;
        max-width: 400px;
        min-height: 990px;
    }

    .notification-popup-header {
        margin-bottom: 14px;
        padding-bottom: 10px;
        border-bottom: 1px solid $border-subtle;

        .popup-title {
            font-size: 16px;
            font-weight: 600;
            color: $text-primary;
            letter-spacing: 0.3px;
        }

        .count-badge {
            background: $purple-primary;
            color: #ffffff;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 14px;
            font-weight: 600;
            margin: 0 8px;
        }

        .clear-all-btn {
            @include smooth-button;
            background: $bg-elevated;
            color: $text-secondary;
            border-radius: 8px;
            padding: 6px 12px;
            font-size: 14px;
            font-weight: 600;

            &:hover {
                background: rgba($red-accent, 0.15);
                color: $red-accent;
            }
        }
    }

    .notification-list {
        padding: 4px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 10px;

        .notification-item {
            padding: 12px;
            margin: 4px 0;
            border-radius: 8px;
            background: $bg-elevated;
            border-left: 3px solid transparent;

            &.urgency-critical {
                border-left-color: $red-accent;
                background: rgba($red-accent, 0.08);
            }

            &.urgency-normal {
                border-left-color: $purple-primary;
            }

            &.urgency-low {
                border-left-color: $text-dim;
                opacity: 0.8;
            }

            .notification-header {
                margin-bottom: 6px;

                .app-icon {
                    font-size: 16px;
                    color: $purple-primary;
                    min-width: 20px;
                }

                .app-name {
                    font-size: 14px;
                    color: $text-secondary;
                    font-weight: 600;
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                }

                .time-ago {
                    font-size: 13px;
                    color: $text-dim;
                    margin-left: auto;
                }

                .dismiss-btn {
                    @include smooth-button;
                    background: transparent;
                    color: $text-dim;
                    border-radius: 4px;
                    min-width: 24px;
                    min-height: 24px;
                    font-size: 16px;
                    padding: 0;
                    opacity: 0.6;

                    &:hover {
                        background: rgba($red-accent, 0.15);
                        color: $red-accent;
                        opacity: 1;
                    }
                }
            }

            .notification-summary {
                font-size: 15px;
                font-weight: 600;
                color: $text-primary;
                margin-bottom: 4px;
            }

            .notification-body {
                font-size: 14px;
                color: $text-secondary;
                line-height: 1.4;
            }

            .notification-actions {
                margin-top: 10px;
                padding-top: 8px;
                border-top: 1px solid $border-subtle;

                .notification-action-btn {
                    @include smooth-button;
                    background: $purple-subtle;
                    color: $purple-primary;
                    border-radius: 6px;
                    padding: 6px 12px;
                    font-size: 14px;
                    font-weight: 600;

                    &:hover {
                        background: rgba($purple-primary, 0.2);
                    }
                }
            }
        }

        .empty-label {
            font-size: 12px;
            color: $text-dim;
            padding: 40px 20px;
            text-align: center;
        }
    }
}

// ============================================================================
// TRAY BUTTON BADGE (for notification count on systray)
// ============================================================================

.systray-btn-wrapper {
    position: relative;

    .badge {
        position: absolute;
        top: 2px;
        right: 0px;
        background: $purple-primary;
        color: #ffffff;
        border-radius: 8px;
        min-width: 16px;
        min-height: 16px;
        font-size: 14px;
        font-weight: 600;
        padding: 0 4px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    }
}

// ============================================================================
// NOTIFICATION OSD - Toast notifications
// ============================================================================

window.NotificationOSD {
    @include popup-base;

    .notification-osd-container {
        margin: 8px;
        margin-right: 4px;
    }

    .notification-toast-wrapper {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

        &.toast-enter {
            opacity: 0;
            transform: translateX(100%);
        }

        &.toast-exit {
            opacity: 0;
            transform: translateX(100%);
            margin-bottom: -100px; // Collapse space
        }
    }

    .notification-toast {
        @include popup-content;
        width: 400px;
        min-width: 400px;
        max-width: 400px;
        padding: 12px;
        margin-bottom: 8px;
        border-left: 3px solid $purple-primary;
        box-sizing: border-box;
        overflow: hidden;

        &.urgency-critical {
            border-left-color: $red-accent;
            background: linear-gradient(180deg, rgba(232, 64, 87, 0.15) 0%, rgba(13, 13, 13, 0.98) 100%);
        }

        &.urgency-normal {
            border-left-color: $purple-primary;
        }

        &.urgency-low {
            border-left-color: $text-dim;
            opacity: 0.9;
        }
    }

    .toast-header {
        margin-bottom: 6px;

        .toast-app-name {
            flex: 1;
            min-width: 0;
        }
    }

    .toast-app-name {
        max-width: 100%;
        word-wrap: break-word;
        overflow-wrap: break-word;
        font-size: 14px;
        color: $text-secondary;
        font-weight: 500;
    }

    .toast-dismiss {
        @include smooth-button;
        background: transparent;
        color: $text-dim;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 16px;

        &:hover {
            background: $bg-hover;
            color: $red-accent;
        }
    }

    .toast-summary {
        font-size: 16px;
        font-weight: 600;
        color: $text-primary;
    }

    .toast-body {
        font-size: 16px;
        color: $text-secondary;
        margin-top: 4px;
        width: 100%;
        word-break: break-word;
        overflow-wrap: break-word;
        overflow: hidden;
    }
}